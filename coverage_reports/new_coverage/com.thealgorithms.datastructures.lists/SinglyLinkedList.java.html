<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SinglyLinkedList.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Java</a> &gt; <a href="index.source.html" class="el_package">com.thealgorithms.datastructures.lists</a> &gt; <span class="el_source">SinglyLinkedList.java</span></div><h1>SinglyLinkedList.java</h1><pre class="source lang-java linenums">package com.thealgorithms.datastructures.lists;

import java.util.StringJoiner;

/**
 * https://en.wikipedia.org/wiki/Linked_list
 */
<span class="nc bnc" id="L8" title="All 2 branches missed.">public class SinglyLinkedList extends Node {</span>

    /**
     * Head refer to the front of the list
     */
    private Node head;

    /**
     * Size of SinglyLinkedList
     */
    private int size;

    /**
     * Init SinglyLinkedList
     */
<span class="nc" id="L23">    public SinglyLinkedList() {</span>
<span class="nc" id="L24">        head = null;</span>
<span class="nc" id="L25">        size = 0;</span>
<span class="nc" id="L26">    }</span>

    /**
     * Init SinglyLinkedList with specified head node and size
     *
     * @param head the head node of list
     * @param size the size of list
     */
<span class="nc" id="L34">    public SinglyLinkedList(Node head, int size) {</span>
<span class="nc" id="L35">        this.head = head;</span>
<span class="nc" id="L36">        this.size = size;</span>
<span class="nc" id="L37">    }</span>

    /**
     * Detects if there is a loop in the singly linked list using floy'd turtle
     * and hare algorithm.
     *
     */
    public boolean detectLoop() {
<span class="nc" id="L45">        Node currentNodeFast = head;</span>
<span class="nc" id="L46">        Node currentNodeSlow = head;</span>
<span class="nc bnc" id="L47" title="All 4 branches missed.">        while (currentNodeFast != null &amp;&amp; currentNodeFast.next != null) {</span>
<span class="nc" id="L48">            currentNodeFast = currentNodeFast.next.next;</span>
<span class="nc" id="L49">            currentNodeSlow = currentNodeSlow.next;</span>
<span class="nc bnc" id="L50" title="All 2 branches missed.">            if (currentNodeFast == currentNodeSlow) {</span>
<span class="nc" id="L51">                return true;</span>
            }
        }
<span class="nc" id="L54">        return false;</span>
    }

    /**
     * Swaps nodes of two given values a and b.
     *
     */
    public void swapNodes(int valueFirst, int valueSecond) {
<span class="nc bnc" id="L62" title="All 2 branches missed.">        if (valueFirst == valueSecond) {</span>
<span class="nc" id="L63">            return;</span>
        }
<span class="nc" id="L65">        Node previousA = null, currentA = head;</span>
<span class="nc bnc" id="L66" title="All 4 branches missed.">        while (currentA != null &amp;&amp; currentA.value != valueFirst) {</span>
<span class="nc" id="L67">            previousA = currentA;</span>
<span class="nc" id="L68">            currentA = currentA.next;</span>
        }

<span class="nc" id="L71">        Node previousB = null, currentB = head;</span>
<span class="nc bnc" id="L72" title="All 4 branches missed.">        while (currentB != null &amp;&amp; currentB.value != valueSecond) {</span>
<span class="nc" id="L73">            previousB = currentB;</span>
<span class="nc" id="L74">            currentB = currentB.next;</span>
        }
        /** If either of 'a' or 'b' is not present, then return */
<span class="nc bnc" id="L77" title="All 4 branches missed.">        if (currentA == null || currentB == null) {</span>
<span class="nc" id="L78">            return;</span>
        }

        // If 'a' is not head node of list
<span class="nc bnc" id="L82" title="All 2 branches missed.">        if (previousA != null) {</span>
<span class="nc" id="L83">            previousA.next = currentB;</span>
        } else {
            // make 'b' as the new head
<span class="nc" id="L86">            head = currentB;</span>
        }

        // If 'b' is not head node of list
<span class="nc bnc" id="L90" title="All 2 branches missed.">        if (previousB != null) {</span>
<span class="nc" id="L91">            previousB.next = currentA;</span>
        } else {
            // Make 'a' as new head
<span class="nc" id="L94">            head = currentA;</span>
        }
        // Swap next pointer

<span class="nc" id="L98">        Node temp = currentA.next;</span>
<span class="nc" id="L99">        currentA.next = currentB.next;</span>
<span class="nc" id="L100">        currentB.next = temp;</span>
<span class="nc" id="L101">    }</span>

    /**
     * Reverse a singly linked list from a given node till the end
     *
     */
    Node reverseList(Node node) {
<span class="nc" id="L108">        Node prevNode = head;</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">        while (prevNode.next != node) {</span>
<span class="nc" id="L110">            prevNode = prevNode.next;</span>
        }
<span class="nc" id="L112">        Node prev = null, curr = node, next;</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">        while (curr != null) {</span>
<span class="nc" id="L114">            next = curr.next;</span>
<span class="nc" id="L115">            curr.next = prev;</span>
<span class="nc" id="L116">            prev = curr;</span>
<span class="nc" id="L117">            curr = next;</span>
        }
<span class="nc" id="L119">        prevNode.next = prev;</span>
<span class="nc" id="L120">        return head;</span>
    }

    /**
     * Clear all nodes in the list
     */
    public void clear() {
<span class="nc" id="L127">        Node cur = head;</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">        while (cur != null) {</span>
<span class="nc" id="L129">            Node prev = cur;</span>
<span class="nc" id="L130">            cur = cur.next;</span>
<span class="nc" id="L131">            prev = null; // clear to let GC do its work</span>
<span class="nc" id="L132">        }</span>
<span class="nc" id="L133">        head = null;</span>
<span class="nc" id="L134">        size = 0;</span>
<span class="nc" id="L135">    }</span>

    /**
     * Checks if the list is empty
     *
     * @return {@code true} if list is empty, otherwise {@code false}.
     */
    public boolean isEmpty() {
<span class="nc bnc" id="L143" title="All 2 branches missed.">        return size == 0;</span>
    }

    /**
     * Returns the size of the linked list.
     *
     * @return the size of the list.
     */
    public int size() {
<span class="nc" id="L152">        return size;</span>
    }

    /**
     * Get head of the list.
     *
     * @return head of the list.
     */
    public Node getHead() {
<span class="nc" id="L161">        return head;</span>
    }

    /**
     * Set head of the list.
     *
     */
    public void setHead(Node head) {
<span class="nc" id="L169">        this.head = head;</span>
<span class="nc" id="L170">    }</span>

    /**
     * Calculate the count of the list manually
     *
     * @return count of the list
     */
    public int count() {
<span class="nc" id="L178">        int count = 0;</span>
<span class="nc" id="L179">        Node cur = head;</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">        while (cur != null) {</span>
<span class="nc" id="L181">            cur = cur.next;</span>
<span class="nc" id="L182">            count++;</span>
        }
<span class="nc" id="L184">        return count;</span>
    }

    /**
     * Test if the value key is present in the list.
     *
     * @param key the value to be searched.
     * @return {@code true} if key is present in the list, otherwise
     * {@code false}.
     */
    public boolean search(int key) {
<span class="nc" id="L195">        Node cur = head;</span>
<span class="nc bnc" id="L196" title="All 2 branches missed.">        while (cur != null) {</span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">            if (cur.value == key) {</span>
<span class="nc" id="L198">                return true;</span>
            }
<span class="nc" id="L200">            cur = cur.next;</span>
        }
<span class="nc" id="L202">        return false;</span>
    }

    @Override
    public String toString() {
<span class="nc" id="L207">        StringJoiner joiner = new StringJoiner(&quot;-&gt;&quot;);</span>
<span class="nc" id="L208">        Node cur = head;</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">        while (cur != null) {</span>
<span class="nc" id="L210">            joiner.add(cur.value + &quot;&quot;);</span>
<span class="nc" id="L211">            cur = cur.next;</span>
        }
<span class="nc" id="L213">        return joiner.toString();</span>
    }

    public void deleteDuplicates() {
<span class="nc" id="L217">        Node pred = head;</span>
        // predecessor = the node
        // having sublist of its duplicates
<span class="nc" id="L220">        Node newHead = head;</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">        while (newHead != null) {</span>
            // if it's a beginning of duplicates sublist
            // skip all duplicates
<span class="nc bnc" id="L224" title="All 4 branches missed.">            if (newHead.next != null &amp;&amp; newHead.value == newHead.next.value) {</span>
                // move till the end of duplicates sublist
<span class="nc bnc" id="L226" title="All 4 branches missed.">                while (</span>
                    newHead.next != null &amp;&amp; newHead.value == newHead.next.value
                ) {
<span class="nc" id="L229">                    newHead = newHead.next;</span>
                }
                // skip all duplicates
<span class="nc" id="L232">                pred.next = newHead.next;</span>
<span class="nc" id="L233">                newHead = null;</span>
                // otherwise, move predecessor
            }
            // move forward
<span class="nc" id="L237">            pred = pred.next;</span>
<span class="nc" id="L238">            newHead = pred;</span>
        }
<span class="nc" id="L240">    }</span>

    public void print() {
<span class="nc" id="L243">        Node temp = head;</span>
<span class="nc bnc" id="L244" title="All 4 branches missed.">        while (temp != null &amp;&amp; temp.next != null) {</span>
<span class="nc" id="L245">            System.out.print(temp.value + &quot;-&gt;&quot;);</span>
<span class="nc" id="L246">            temp = temp.next;</span>
        }
<span class="nc bnc" id="L248" title="All 2 branches missed.">        if (temp != null) {</span>
<span class="nc" id="L249">            System.out.print(temp.value);</span>
<span class="nc" id="L250">            System.out.println();</span>
        }
<span class="nc" id="L252">    }</span>

    /**
     * Inserts an element at the head of the list
     *
     * @param x element to be added
     */
    public void insertHead(int x) {
<span class="nc" id="L260">        insertNth(x, 0);</span>
<span class="nc" id="L261">    }</span>

    /**
     * Insert an element at the tail of the list
     *
     * @param data element to be added
     */
    public void insert(int data) {
<span class="nc" id="L269">        insertNth(data, size);</span>
<span class="nc" id="L270">    }</span>

    /**
     * Inserts a new node at a specified position of the list
     *
     * @param data data to be stored in a new node
     * @param position position at which a new node is to be inserted
     */
    public void insertNth(int data, int position) {
<span class="nc" id="L279">        checkBounds(position, 0, size);</span>
<span class="nc" id="L280">        Node newNode = new Node(data);</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">        if (head == null) {</span>
            /* the list is empty */
<span class="nc" id="L283">            head = newNode;</span>
<span class="nc" id="L284">            size++;</span>
<span class="nc" id="L285">            return;</span>
        }
<span class="nc bnc" id="L287" title="All 2 branches missed.">        if (position == 0) {</span>
            /* insert at the head of the list */
<span class="nc" id="L289">            newNode.next = head;</span>
<span class="nc" id="L290">            head = newNode;</span>
<span class="nc" id="L291">            size++;</span>
<span class="nc" id="L292">            return;</span>
        }

<span class="nc" id="L295">        Node cur = head;</span>
<span class="nc bnc" id="L296" title="All 2 branches missed.">        for (int i = 0; i &lt; position - 1; ++i) {</span>
<span class="nc" id="L297">            cur = cur.next;</span>
        }
<span class="nc" id="L299">        newNode.next = cur.next;</span>
<span class="nc" id="L300">        cur.next = newNode;</span>
<span class="nc" id="L301">        size++;</span>
<span class="nc" id="L302">    }</span>

    /**
     * Swaps nodes of two given values a and b.
     *
     */

    /**
     * Deletes a node at the head
     */
    public void deleteHead() {
<span class="nc" id="L313">        deleteNth(0);</span>
<span class="nc" id="L314">    }</span>

    /**
     * Deletes an element at the tail
     */
    public void delete() {
<span class="nc" id="L320">        deleteNth(size - 1);</span>
<span class="nc" id="L321">    }</span>

    /**
     * Deletes an element at Nth position
     */
    public void deleteNth(int position) {
<span class="nc" id="L327">        checkBounds(position, 0, size - 1);</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">        if (position == 0) {</span>
<span class="nc" id="L329">            Node destroy = head;</span>
<span class="nc" id="L330">            head = head.next;</span>
<span class="nc" id="L331">            destroy = null;</span>
            /* clear to let GC do its work */
<span class="nc" id="L333">            size--;</span>
<span class="nc" id="L334">            return;</span>
        }
<span class="nc" id="L336">        Node cur = head;</span>
<span class="nc bnc" id="L337" title="All 2 branches missed.">        for (int i = 0; i &lt; position - 1; ++i) {</span>
<span class="nc" id="L338">            cur = cur.next;</span>
        }

<span class="nc" id="L341">        Node destroy = cur.next;</span>
<span class="nc" id="L342">        cur.next = cur.next.next;</span>
<span class="nc" id="L343">        destroy = null; // clear to let GC do its work</span>

<span class="nc" id="L345">        size--;</span>
<span class="nc" id="L346">    }</span>

    /**
     * Return element at special index.
     *
     * @param index given index of element
     * @return element at special index.
     */
    public int getNth(int index) {
<span class="nc" id="L355">        checkBounds(index, 0, size - 1);</span>
<span class="nc" id="L356">        Node cur = head;</span>
<span class="nc bnc" id="L357" title="All 2 branches missed.">        for (int i = 0; i &lt; index; ++i) {</span>
<span class="nc" id="L358">            cur = cur.next;</span>
        }
<span class="nc" id="L360">        return cur.value;</span>
    }

    /**
     * @param position to check position
     * @param low low index
     * @param high high index
     * @throws IndexOutOfBoundsException if {@code position} not in range
     * {@code low} to {@code high}
     */
    public void checkBounds(int position, int low, int high) {
<span class="nc bnc" id="L371" title="All 4 branches missed.">        if (position &gt; high || position &lt; low) {</span>
<span class="nc" id="L372">            throw new IndexOutOfBoundsException(position + &quot;&quot;);</span>
        }
<span class="nc" id="L374">    }</span>

    /**
     * Driver Code
     */
    public static void main(String[] arg) {
<span class="nc" id="L380">        SinglyLinkedList list = new SinglyLinkedList();</span>
<span class="nc bnc" id="L381" title="All 4 branches missed.">        assert list.isEmpty();</span>
<span class="nc bnc" id="L382" title="All 6 branches missed.">        assert list.size() == 0 &amp;&amp; list.count() == 0;</span>
<span class="nc bnc" id="L383" title="All 4 branches missed.">        assert list.toString().equals(&quot;&quot;);</span>

        /* Test insert function */
<span class="nc" id="L386">        list.insertHead(5);</span>
<span class="nc" id="L387">        list.insertHead(7);</span>
<span class="nc" id="L388">        list.insertHead(10);</span>
<span class="nc" id="L389">        list.insert(3);</span>
<span class="nc" id="L390">        list.insertNth(1, 4);</span>
<span class="nc bnc" id="L391" title="All 4 branches missed.">        assert list.toString().equals(&quot;10-&gt;7-&gt;5-&gt;3-&gt;1&quot;);</span>
<span class="nc" id="L392">        System.out.println(list.toString());</span>
        /* Test search function */
<span class="nc bnc" id="L394" title="All 4 branches missed.">        assert list.search(10) &amp;&amp;</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">        list.search(5) &amp;&amp;</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">        list.search(1) &amp;&amp;</span>
<span class="nc bnc" id="L397" title="All 2 branches missed.">        !list.search(100);</span>

        /* Test get function */
<span class="nc bnc" id="L400" title="All 4 branches missed.">        assert list.getNth(0) == 10 &amp;&amp;</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">        list.getNth(2) == 5 &amp;&amp;</span>
<span class="nc bnc" id="L402" title="All 2 branches missed.">        list.getNth(4) == 1;</span>

        /* Test delete function */
<span class="nc" id="L405">        list.deleteHead();</span>
<span class="nc" id="L406">        list.deleteNth(1);</span>
<span class="nc" id="L407">        list.delete();</span>
<span class="nc bnc" id="L408" title="All 4 branches missed.">        assert list.toString().equals(&quot;7-&gt;3&quot;);</span>
<span class="nc" id="L409">        System.out.println(list.toString());</span>
<span class="nc bnc" id="L410" title="All 6 branches missed.">        assert list.size == 2 &amp;&amp; list.size() == list.count();</span>

<span class="nc" id="L412">        list.clear();</span>
<span class="nc bnc" id="L413" title="All 4 branches missed.">        assert list.isEmpty();</span>

        try {
<span class="nc" id="L416">            list.delete();</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">            assert false;</span>
            /* this should not happen */
<span class="nc" id="L419">        } catch (Exception e) {</span>
            assert true;
            /* this should happen */
<span class="nc" id="L422">        }</span>

<span class="nc" id="L424">        SinglyLinkedList instance = new SinglyLinkedList();</span>
<span class="nc" id="L425">        Node head = new Node(</span>
            0,
            new Node(2, new Node(3, new Node(3, new Node(4))))
        );
<span class="nc" id="L429">        instance.setHead(head);</span>
<span class="nc" id="L430">        instance.deleteDuplicates();</span>
<span class="nc" id="L431">        instance.print();</span>
<span class="nc" id="L432">    }</span>
}

/**
 * This class is the nodes of the SinglyLinked List. They consist of a value and
 * a pointer to the node after them.
 */
class Node {

    /**
     * The value of the node
     */
    int value;

    /**
     * Point to the next node
     */
    Node next;

<span class="nc" id="L451">    Node() {}</span>

    /**
     * Constructor
     *
     * @param value Value to be put in the node
     */
    Node(int value) {
<span class="nc" id="L459">        this(value, null);</span>
<span class="nc" id="L460">    }</span>

    /**
     * Constructor
     *
     * @param value Value to be put in the node
     * @param next Reference to the next node
     */
<span class="nc" id="L468">    Node(int value, Node next) {</span>
<span class="nc" id="L469">        this.value = value;</span>
<span class="nc" id="L470">        this.next = next;</span>
<span class="nc" id="L471">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>